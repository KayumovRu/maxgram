# Быстрый старт

## Получение токена

Для начала работы с API Max вам потребуется получить токен бота. Для этого:

1. Откройте диалог с [MasterBot](https://max.ru/masterbot)
2. Следуйте инструкциям для создания нового бота
3. После завершения процесса MasterBot отправит вам токен доступа

## Установка библиотеки

Установите библиотеку Maxgram с помощью pip:

```sh
pip install maxgram
```

## Пример простого бота

Вот пример простого бота, который:
- Отвечает на команду `/ping` сообщением "pong"
- Приветствует пользователя при запуске бота
- Отвечает на сообщение "hello" текстом "world"
- Повторяет все другие входящие сообщения

```python
from maxgram import Bot

# Инициализация бота с токеном
bot = Bot("YOUR_BOT_TOKEN")

# Обработчик события запуска бота
@bot.on("bot_started")
def on_start(ctx):
    ctx.reply("Привет! Отправь мне команду /ping, чтобы сыграть в пинг-понг")

# Обработчик команды '/ping'
@bot.command("ping")
def ping_command(ctx):
    ctx.reply("pong")

# Обработчик для сообщения с текстом 'hello'
@bot.hears("hello")
def hello_handler(ctx):
    ctx.reply("world")

# Обработчик для всех остальных входящих сообщений
@bot.on("message_created")
def echo(ctx):
    if ctx.message and ctx.message.get("body") and "text" in ctx.message["body"]:
        ctx.reply(ctx.message["body"]["text"])

# Запуск бота
import asyncio
asyncio.run(bot.start())
```

> **Примечание**: В текущей версии API Max команды для бота (`/команда`) можно установить только через MasterBot. Метод `bot.api.set_my_commands()` оставлен в библиотеке для обратной совместимости, но он не выполняет фактическую установку команд.

## Обработчики событий

В Maxgram можно регистрировать обработчики на различные типы событий:

- `@bot.on(event_type)` - Обработчик для указанного типа события
- `@bot.command(command_name)` - Обработчик для команды (без слеша)
- `@bot.hears(pattern)` - Обработчик для сообщений с определенным текстом

### Типы событий

- `message_created` - Создание нового сообщения
- `message_callback` - Нажатие на кнопку в сообщении
- `bot_started` - Запуск бота пользователем
- `message_edited` - Редактирование сообщения
- `message_deleted` - Удаление сообщения
- `message_chat_created` - Создание чата через кнопку

## Обработка ошибок

По умолчанию, библиотека логирует ошибки и продолжает работу. Вы можете изменить это поведение:

```python
@bot.catch
def handle_error(error, update):
    print(f"Произошла ошибка: {error}")
    print(f"При обработке обновления: {update}")
    # Можно выполнить специальные действия при ошибке
```

> ⚠️ Завершайте работу программы при неизвестных ошибках, иначе бот может зависнуть в состоянии ошибки. 